name: Pruebas Automáticas de Calidad y Funcionalidad

on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

jobs:
  # 🔍 Verificación de Código con ShellCheck
  linting:
    name: Verificación con ShellCheck
    runs-on: ubuntu-latest
    timeout-minutes: 2  # ⏳ Detiene la ejecución si tarda más de 2 minutos

    steps:
      - name: 📥 Checkout del código
        uses: actions/checkout@v3

      - name: 🔍 Instalar ShellCheck (sin actualizar paquetes)
        run: sudo apt install -y shellcheck

      - name: ✅ Ejecutar ShellCheck
        run: shellcheck creador.sh || exit 1

  # 🧪 Pruebas Funcionales con Bats
  functional_tests:
    name: Pruebas con Bats
    runs-on: ubuntu-latest
    timeout-minutes: 2  # ⏳ Límite para evitar bloqueos

    steps:
      - name: 📥 Checkout del código
        uses: actions/checkout@v3

      - name: 🔍 Instalar Bats (sin actualización lenta)
        run: sudo apt install -y bats

      - name: 🧪 Ejecutar pruebas con Bats
        run: bats tests/test_subcreator.bats || exit 1
